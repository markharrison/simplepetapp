@page "/"
@inject IVenueService VenueService
@inject NavigationManager Navigation

<div class="home-page">
    <section class="hero">
        <div class="hero-content animate-fade-in">
            <h1 class="text-gradient">Discover Pet-Friendly Venues</h1>
            <p class="hero-subtitle">Find the perfect places to explore with your furry friends</p>
            <div class="hero-buttons">
                <button class="btn btn-primary" @onclick='() => Navigation.NavigateTo("/venues")'>Explore Venues</button>
                <button class="btn btn-secondary" @onclick='() => Navigation.NavigateTo("/booking")'>Book Now</button>
            </div>
            <div class="hero-emojis animate-float">ğŸ• ğŸ± ğŸ¦ ğŸ°</div>
        </div>
    </section>

    <section class="search-section">
        <SearchFilters OnSearch="HandleSearch" />
    </section>

    <section class="categories">
        <h2>Explore by Category</h2>
        <div class="category-grid">
            <div class="category-card" @onclick='() => Navigation.NavigateTo("/venues?type=Park")'>
                <span class="category-icon">ğŸŒ³</span>
                <h3>Parks</h3>
            </div>
            <div class="category-card" @onclick='() => Navigation.NavigateTo("/venues?type=Cafe")'>
                <span class="category-icon">â˜•</span>
                <h3>CafÃ©s</h3>
            </div>
            <div class="category-card" @onclick='() => Navigation.NavigateTo("/venues?type=Restaurant")'>
                <span class="category-icon">ğŸ½ï¸</span>
                <h3>Restaurants</h3>
            </div>
            <div class="category-card" @onclick='() => Navigation.NavigateTo("/venues?type=Hotel")'>
                <span class="category-icon">ğŸ¨</span>
                <h3>Hotels</h3>
            </div>
            <div class="category-card" @onclick='() => Navigation.NavigateTo("/venues?type=Beach")'>
                <span class="category-icon">ğŸ–ï¸</span>
                <h3>Beaches</h3>
            </div>
            <div class="category-card" @onclick='() => Navigation.NavigateTo("/venues?type=Store")'>
                <span class="category-icon">ğŸ›ï¸</span>
                <h3>Stores</h3>
            </div>
        </div>
    </section>

    <section class="featured-venues">
        <h2>Featured Venues</h2>
        @if (featuredVenues == null)
        {
            <p>Loading...</p>
        }
        else
        {
            <div class="venue-grid">
                @foreach (var venue in featuredVenues)
                {
                    <VenueCard Venue="@venue" IsFeatured="true" OnClick='() => Navigation.NavigateTo($"/venues/{venue.Id}")' />
                }
            </div>
        }
    </section>

    <section class="cta-section">
        <h2>Join Thousands of Pet Lovers</h2>
        <p>Discover amazing pet-friendly venues in your area</p>
        <button class="btn btn-primary" @onclick='() => Navigation.NavigateTo("/venues")'>Get Started</button>
    </section>
</div>

@code {
    private List<Venue>? featuredVenues;

    protected override async Task OnInitializedAsync()
    {
        featuredVenues = await VenueService.GetFeaturedVenuesAsync();
    }

    private void HandleSearch((string?, VenueType?, PetType?) filters)
    {
        var (search, type, pet) = filters;
        var query = System.Web.HttpUtility.ParseQueryString(string.Empty);
        if (!string.IsNullOrEmpty(search)) query["search"] = search;
        if (type.HasValue) query["type"] = type.ToString();
        if (pet.HasValue) query["pet"] = pet.ToString();
        Navigation.NavigateTo($"/venues?{query}");
    }
}
